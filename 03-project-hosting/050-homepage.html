

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>3.5. 建立主页 &mdash; GotGitHub v0.1 documentation</title>
    <link rel="stylesheet" href="../static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../static/jquery.js"></script>
    <script type="text/javascript" src="../static/underscore.js"></script>
    <script type="text/javascript" src="../static/doctools.js"></script>
    <link rel="top" title="GotGitHub v0.1 documentation" href="../index.html" />
    <link rel="up" title="3. 项目托管" href="index.html" />
    <link rel="next" title="4. 工作协同" href="../04-work-with-others/index.html" />
    <link rel="prev" title="3.4. 版本库钩子扩展" href="040-repo-hooks.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../04-work-with-others/index.html" title="4. 工作协同"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="040-repo-hooks.html" title="3.4. 版本库钩子扩展"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">GotGitHub v0.1 documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">3. 项目托管</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">3.5. 建立主页</a><ul>
<li><a class="reference internal" href="#id2">3.5.1. 创建个人主页</a></li>
<li><a class="reference internal" href="#id3">3.5.2. 创建项目主页</a></li>
<li><a class="reference internal" href="#id4">3.5.3. 使用专有域名</a></li>
<li><a class="reference internal" href="#jekyll">3.5.4. 使用Jekyll维护网站</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="040-repo-hooks.html"
                        title="previous chapter">3.4. 版本库钩子扩展</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../04-work-with-others/index.html"
                        title="next chapter">4. 工作协同</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../sources/03-project-hosting/050-homepage.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="id1">
<h1>3.5. 建立主页<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<p>很多开源项目托管平台都支持为托管的项目建立主页，但主页的维护方式都没有GitHub这么酷。大多数托管平台无非是开放一个FTP或类似服务，用户把制作好的网页或脚本上传了事，而GitHub采用创建特殊名称的Git版本库或在Git库中建立特别的分支实现主页的创建。</p>
<div class="section" id="id2">
<h2>3.5.1. 创建个人主页<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>为自己在GitHub的账号创建主页很容易，只要在托管空间下创建一个名为 <tt class="docutils literal"><span class="pre">&lt;userid&gt;.github.com</span></tt> 的版本库，在其中提交网站页面即可。以 <tt class="docutils literal"><span class="pre">gotgithub</span></tt> 用户为例。</p>
<ul>
<li><p class="first">创建一个名为 <tt class="docutils literal"><span class="pre">gotgithub.github.com</span></tt> 的Git版本库。</p>
</li>
<li><p class="first">在本地克隆新建立的版本库。</p>
<div class="highlight-python"><pre>$ git clone git@github.com:gotgithub/gotgithub.github.com.git
$ cd gotgithub.github.com/</pre>
</div>
</li>
<li><p class="first">在版本库根目录中创建文件 <tt class="docutils literal"><span class="pre">index.html</span></tt> 作为首页。</p>
<div class="highlight-python"><pre>$ printf "&lt;h1&gt;GotGitHub's HomePage&lt;/h1&gt;It works.\n" &gt; index.html</pre>
</div>
</li>
<li><p class="first">建立提交。</p>
<div class="highlight-python"><pre>$ git add index.html
$ git commit -m "Homepage test version."</pre>
</div>
</li>
<li><p class="first">推送到GitHub，完成远程版本库创建。</p>
<div class="highlight-python"><pre>$ git push origin master</pre>
</div>
</li>
<li><p class="first">访问网址： <a class="reference external" href="http://gotgithub.github.com/">http://gotgithub.github.com/</a> 。</p>
<p>最多等待10分钟，GitHub就可以完成新网站的部署。注意个人首页使用HTTP协议非HTTPS协议。</p>
</li>
</ul>
</div>
<div class="section" id="id3">
<h2>3.5.2. 创建项目主页<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>GitHub会为每个用户分配一个子域名作为用户主页，同样用户创建的每一个项目也会在用户主页下创建一个子网站。例如 <tt class="docutils literal"><span class="pre">gotgithub</span></tt> 用户创建的 <tt class="docutils literal"><span class="pre">helloworld</span></tt> 项目经过简单的定制，会在地址 <tt class="docutils literal"><span class="pre">http://gotgithub.github.com/helloworld/</span></tt> 下创建项目首页。为项目建立自定义项目首页只需要在项目版本库中创建一个名为 <tt class="docutils literal"><span class="pre">gh-pages</span></tt> 的分支，并把网页提交到该分支即可。</p>
<p>如果本地尚未建立 <tt class="docutils literal"><span class="pre">helloworld</span></tt> 版本库克隆，执行如下命令。</p>
<div class="highlight-python"><pre>$ git clone git@github.com:gotgithub/helloworld.git
$ cd helloworld</pre>
</div>
<p>当前版本库只有一个名为 <tt class="docutils literal"><span class="pre">master</span></tt> 的分支，如果直接从 <tt class="docutils literal"><span class="pre">master</span></tt> 分支创建 <tt class="docutils literal"><span class="pre">gh-pages</span></tt> 分支操作非常简单，但是作为保存网页的 <tt class="docutils literal"><span class="pre">gh-pages</span></tt> 分支中的内容和 <tt class="docutils literal"><span class="pre">master</span></tt> 分支中的完全不同。如果不希望 <tt class="docutils literal"><span class="pre">gh-pages</span></tt> 分支继承 <tt class="docutils literal"><span class="pre">master</span></tt> 分支的历史和文件，即想要创建一个干净的 <tt class="docutils literal"><span class="pre">gh-pages</span></tt> 分支，需要一点小技巧。可以从下面两个方法任选一种。</p>
<p>第一种方法用到两个Git底层命令： <tt class="docutils literal"><span class="pre">git</span> <span class="pre">write-tree</span></tt> 和 <tt class="docutils literal"><span class="pre">git</span> <span class="pre">commit-tree</span></tt> 。步骤如下：</p>
<ul>
<li><p class="first">基于 <tt class="docutils literal"><span class="pre">master</span></tt> 分支建立分支 <tt class="docutils literal"><span class="pre">gh-pages</span></tt> 。</p>
<div class="highlight-python"><pre>$ git checkout -b gh-pages</pre>
</div>
</li>
<li><p class="first">删除暂存区文件，即相当于清空暂存区。</p>
<div class="highlight-python"><pre>$ rm .git/index</pre>
</div>
</li>
<li><p class="first">创建项目首页 <tt class="docutils literal"><span class="pre">index.html</span></tt> 。</p>
<div class="highlight-python"><pre>$ printf "hello world.\n" &gt; index.html</pre>
</div>
</li>
<li><p class="first">添加文件 <tt class="docutils literal"><span class="pre">index.html</span></tt> 到暂存区。</p>
<div class="highlight-python"><pre>$ git add index.html</pre>
</div>
</li>
<li><p class="first">用Git底层命令创建新的根提交，并将分支 <tt class="docutils literal"><span class="pre">gh-pages</span></tt> 重置。</p>
<div class="highlight-python"><pre>$ git reset --hard $(echo "branch gh-pages init." | git commit-tree $(git write-tree))</pre>
</div>
</li>
<li><p class="first">执行推送命令，在GitHub远程版本库创建分支 <tt class="docutils literal"><span class="pre">gh-pages</span></tt> 。</p>
<div class="highlight-python"><pre>$ git push origin gh-pages</pre>
</div>
</li>
</ul>
<p>第二种方法用到Git底层命令： <tt class="docutils literal"><span class="pre">git</span> <span class="pre">symbolic-ref</span></tt> 。步骤如下：</p>
<ul>
<li><p class="first">用 <tt class="docutils literal"><span class="pre">git</span> <span class="pre">symbolic-ref</span></tt> 命令将当前工作分支由 <tt class="docutils literal"><span class="pre">master</span></tt> 切换到一个尚不存在的分支 <tt class="docutils literal"><span class="pre">gh-pages</span></tt> 。</p>
<div class="highlight-python"><pre>$ git symbolic-ref HEAD refs/heads/gh-pages</pre>
</div>
</li>
<li><p class="first">删除暂存区文件，即相当于清空暂存区。</p>
<div class="highlight-python"><pre>$ rm .git/index</pre>
</div>
</li>
<li><p class="first">创建项目首页 <tt class="docutils literal"><span class="pre">index.html</span></tt> 。</p>
<div class="highlight-python"><pre>$ printf "hello world.\n" &gt; index.html</pre>
</div>
</li>
<li><p class="first">添加文件 <tt class="docutils literal"><span class="pre">index.html</span></tt> 到暂存区。</p>
<div class="highlight-python"><pre>$ git add index.html</pre>
</div>
</li>
<li><p class="first">执行提交。提交完毕分支 <tt class="docutils literal"><span class="pre">gh-pages</span></tt> 完成创建。</p>
<div class="highlight-python"><pre>$ git commit --m "branch gh-pages init."</pre>
</div>
</li>
<li><p class="first">执行推送命令，在GitHub远程版本库创建分支 <tt class="docutils literal"><span class="pre">gh-pages</span></tt> 。</p>
<div class="highlight-python"><pre>$ git push origin gh-pages</pre>
</div>
</li>
</ul>
<p>无论哪种方法，一旦在GitHub远程版本库中创建分支 <tt class="docutils literal"><span class="pre">gh-pages</span></tt> ，项目的主页就已经建立。稍后（不超过10分钟），用浏览器访问下面的地址即可看到刚刚提交的项目首页。</p>
<ul class="simple">
<li><a class="reference external" href="http://gotgithub.github.com/helloworld/">http://gotgithub.github.com/helloworld/</a></li>
</ul>
<p>除了以上用命令行方式创建 <tt class="docutils literal"><span class="pre">gh-pages</span></tt> 分支的方式为项目设定主页外，GitHub还在项目管理界面还提供了图形操作界面。如图3-19所示。</p>
<div class="figure">
<a class="reference internal image-reference" href="../images/github-pages.png"><img alt="../images/github-pages.png" src="../images/github-pages.png" /></a>
<p class="caption">图3-19：项目管理页面中的GitHub Pages选项</p>
</div>
<p>当在项目管理页面中勾选”GitHub Pages“选项，并按照提示操作，自动在项目版本库中创建 <tt class="docutils literal"><span class="pre">gh-pages</span></tt> 分支。然后执行下面命令从版本库检出 <tt class="docutils literal"><span class="pre">gh-pages</span></tt> 分支，对项目主页进行相应定制。</p>
<div class="highlight-python"><pre>$ cd helloworld
$ git fetch
$ git clone -b gh-pages origin/gh-pages</pre>
</div>
</div>
<div class="section" id="id4">
<h2>3.5.3. 使用专有域名<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>无论是用户主页还是项目主页，除了使用 <tt class="docutils literal"><span class="pre">github.com</span></tt> 下的子域名访问之外，还可以使用指定的专有域名。实现起来也非常简单，只要在 <tt class="docutils literal"><span class="pre">master</span></tt> 分支（用户主页所在版本库）或 <tt class="docutils literal"><span class="pre">gh-pages</span></tt> 分支（项目版本库）的根目录下检入一个名为 <tt class="docutils literal"><span class="pre">CNAME</span></tt> 的文件，内容为相应的专有域名。</p>
<p>例如用户拥有的专有域名为 <tt class="docutils literal"><span class="pre">example.com</span></tt> ，希望访问 <tt class="docutils literal"><span class="pre">example.com</span></tt> 时实际得到的是 <tt class="docutils literal"><span class="pre">gotgithub.github.com</span></tt> 网页的内容。只需进行如下操作：</p>
<ul class="simple">
<li>在GitHub的 <tt class="docutils literal"><span class="pre">gotgithub</span></tt> 账户的 <tt class="docutils literal"><span class="pre">gotgithub.github.com</span></tt> 版本库的根目录下添加文件 <tt class="docutils literal"><span class="pre">CNAME</span></tt> ，文件内容为： <tt class="docutils literal"><span class="pre">example.com</span></tt> 。</li>
<li>然后将域名 <tt class="docutils literal"><span class="pre">example.com</span></tt> 的IP指向 <tt class="docutils literal"><span class="pre">gotgithub.github.com</span></tt> 的IP地址（注意不是 <tt class="docutils literal"><span class="pre">github.com</span></tt> 的IP地址）。</li>
</ul>
<p>设置完成后，访问 <tt class="docutils literal"><span class="pre">example.com</span></tt> 即可看到 <tt class="docutils literal"><span class="pre">gotgithub</span></tt> 用户在GitHub的个人主页。访问 <tt class="docutils literal"><span class="pre">gotgithub.github.com</span></tt> 网站亦会重定向到 <tt class="docutils literal"><span class="pre">example.com</span></tt> 。</p>
<p>看一个实际的例子： <a class="reference external" href="http://github.com/mojombo/mojombo.github.com/">http://github.com/mojombo/mojombo.github.com/</a> → <a class="reference external" href="http://tom.preston-werner.com/">http://tom.preston-werner.com/</a> 。</p>
</div>
<div class="section" id="jekyll">
<h2>3.5.4. 使用Jekyll维护网站<a class="headerlink" href="#jekyll" title="Permalink to this headline">¶</a></h2>
<p>Jekyll是由Tom Preston-Werner（GitHub创始人之一）开发的静态网站生成软件，支持博客及网页模版。使用Jekyll，可以直接使用Markdown或其他标记语言撰写页面及博客，当GitHub托管的版本库更新后，GitHub会自动运行Jekyll将标记语言撰写的文件转换为网页。</p>
<p>Jekyll用Ruby语言开发，项目在GitHub的托管地址： <a class="reference external" href="http://github.com/mojombo/jekyll/">http://github.com/mojombo/jekyll/</a> ，专有的URL地址为： <a class="reference external" href="http://jekyllrb.com/">http://jekyllrb.com/</a> 。安装Jekyll最简单的方法是通过RubyGems安装，会自动将Jekyll依赖的directory_watcher、liquid、open4、maruku和classifier等Gem包一并安装。</p>
<div class="highlight-python"><pre>$ gem install jekyll</pre>
</div>
<p>如果安装过程因编译扩展模组遇到错误，可能是因为尚未安装所需的头文件。对于Debian Linux、Ubuntu等可以用如下方法安装所需软件包：</p>
<div class="highlight-python"><pre>$ sudo apt-get install ruby1.8-dev</pre>
</div>
<p>如果是Red Hat、CentOS或Fedora等系统，使用如下命令安装：</p>
<div class="highlight-python"><pre>$ sudo yum install ruby-devel</pre>
</div>
<p>对于Mac OSX，可能需要更新RubyGems，如下：</p>
<div class="highlight-python"><pre>$ sudo gem update --system</pre>
</div>
<p>安装完毕，执行下面的命令显示Jekyll的版本：</p>
<div class="highlight-python"><pre>$ jekyll -v
Jekyll 0.11.0</pre>
</div>
<p>先来看一下作者Tom Preston-Werner在GitHub上的个人网站，看看是如何用Jekyll制作出来的。</p>
<p>先克隆版本库：</p>
<div class="highlight-python"><pre>$ git clone git://github.com/mojombo/mojombo.github.com.git
$ cd mojombo.github.com</pre>
</div>
<p>版本库根目录下的 <tt class="docutils literal"><span class="pre">index.html</span></tt> 文件不是一个完整的HTML文件，而是套用了模版（Liquid格式模版）的页面，对其关键内容添加行号显示如下：</p>
<div class="highlight-python"><pre> 1 ---
 2 layout: default
 3 title: Tom Preston-Werner
 4 ---
 5
 6 &lt;div id="home"&gt;
 7   &lt;h1&gt;Blog Posts&lt;/h1&gt;
 8   &lt;ul class="posts"&gt;
 9     {% for post in site.posts %}
10       &lt;li&gt;&lt;span&gt;{{ post.date | date_to_string }}&lt;/span&gt; &amp;raquo; &lt;a href="{{ post.url }}"&gt;{{ post.title }}&lt;/a&gt;&lt;/li&gt;
11     {% endfor %}
12   &lt;/ul&gt;
   ...
63 &lt;/div&gt;</pre>
</div>
<p>第1-4行是YAML格式的文件头，确定模版的对应关系并设定相关属性。凡是设置有YAML文件头的文件（目录 <tt class="docutils literal"><span class="pre">_layouts</span></tt> 等除外）无论文件扩展名为何，都会在Jekyll编译时转换为对应的HTML文件。其中第2行含义为使用default模版（对应于的模版文件为 <tt class="docutils literal"><span class="pre">_layouts/default.html</span></tt> ），第3行设定本页面的标题。</p>
<p>第6行开始的内容绝大多数是标准的HTML语法，其中夹杂少量liquid模版特有的语法。有着liquid或其他模版编程经验的用户，不难理解其中第9行和第11行出现的由”{%“和”%}“标识的指令是一个循环指令（for循环）用于逐条对博客进行相关操作，而第10行中由”{{“和”}}“标识的表达式则用于显示博文的日期、链接和标题。</p>
<p>根目录下的 <tt class="docutils literal"><span class="pre">atom.xml</span></tt> 文件亦套用 <tt class="docutils literal"><span class="pre">default</span></tt> 模版。</p>
<p>目录 <tt class="docutils literal"><span class="pre">_post</span></tt> 下的文件是博客文章列表，每个博文都以 <tt class="docutils literal"><span class="pre">&lt;YYYY&gt;-&lt;MM&gt;-&lt;DD&gt;-&lt;blog-tiltle&gt;</span></tt> 格式的文件名命名。扩展名为 <tt class="docutils literal"><span class="pre">.md</span></tt> 的为Markdown格式，扩展名为 <tt class="docutils literal"><span class="pre">.textile</span></tt> 的为Textile格式。这些文件都类似如下格式的文件头：</p>
<div class="highlight-python"><pre>---
layout: post
title: How I Turned Down $300,000 from Microsoft to go Full-Time on GitHub
---</pre>
</div>
<p>在 <tt class="docutils literal"><span class="pre">_layouts</span></tt> 目录下定义网页模版，其中文件 <tt class="docutils literal"><span class="pre">_layouts/post.html</span></tt> 是博客用到的模版，而 <tt class="docutils literal"><span class="pre">_layouts/default.html</span></tt> 是默认模版。模版文件亦是liquid格式文件。</p>
<p>在根目录下还有一个配置文件 <tt class="docutils literal"><span class="pre">_config.yml</span></tt> 用于覆盖Jekyll的默认设置，例如本版本库中的设置。</p>
<div class="highlight-python"><pre>markdown: rdiscount
pygments: true</pre>
</div>
<p>第1行设置使用rdiscount软件包作为Markdown的解析引擎，而非默认的Maruku。第2行开启pygments支持。关于该配置文件的详细介绍参见 <a class="reference external" href="https://github.com/mojombo/jekyll/wiki/configuration">Jekyll项目维基</a>  。</p>
<p>编译Jekyll编辑网站只需在根目录执行 <tt class="docutils literal"><span class="pre">jekyll</span></tt> 命令，下面的命令是GitHub更新网站所使用的默认指令。</p>
<div class="highlight-python"><pre>$ jekyll --pygments --safe</pre>
</div>
<p>现在执行这条命令，就会将整个网站创建在目录 <tt class="docutils literal"><span class="pre">_site</span></tt> 下。</p>
<p>如果没有安装Apache等Web服务器，还可以使用Jekyll的内置Web服务器。</p>
<div class="highlight-python"><pre>$ jekyll --server</pre>
</div>
<p>默认在端口4000开启Web服务器。</p>
<p>网址 <a class="reference external" href="http://gitready.com/">http://gitready.com/</a> 是一个提供Git使用小窍门的网站，如图3-20所示。</p>
<div class="figure">
<a class="reference internal image-reference" href="../images/gitready.png"><img alt="../images/gitready.png" src="../images/gitready.png" /></a>
<p class="caption">图3-20：Git Ready 网站</p>
</div>
<p>你相信这是一个用Jekyll制作的网站么？看看该网站对应的IP，会发现其指向的正是GitHub。研究GitHub上 <a class="reference external" href="https://github.com/gitready">gitready</a> 用户托管的版本库，会发现 <tt class="docutils literal"><span class="pre">en</span></tt> 版本库的 <tt class="docutils literal"><span class="pre">gh-pages</span></tt> 分支负责生成 <tt class="docutils literal"><span class="pre">gitready.com</span></tt> 网站， <tt class="docutils literal"><span class="pre">de</span></tt> 版本库的 <tt class="docutils literal"><span class="pre">gh-pages</span></tt> 分支负责生成德文网站 <tt class="docutils literal"><span class="pre">de.gitready.com</span></tt> ，等等。而 <tt class="docutils literal"><span class="pre">gitready</span></tt> 版本库则是各种语种网站的汇总。</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../04-work-with-others/index.html" title="4. 工作协同"
             >next</a> |</li>
        <li class="right" >
          <a href="040-repo-hooks.html" title="3.4. 版本库钩子扩展"
             >previous</a> |</li>
        <li><a href="../index.html">GotGitHub v0.1 documentation</a> &raquo;</li>
          <li><a href="index.html" >3. 项目托管</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/"><img alt="知识共享许可协议" style="border-width:0" src="http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" /></a>
      <br />
      全部内容以 <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">Creative Commons 署名-非商业性使用-相同方式共享 3.0 协议发布</a>.
      <br />
        &copy; Copyright 2011, Jiang Xin.
      Last updated on 2011/09/22.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.

    </div>
  </body>
</html>